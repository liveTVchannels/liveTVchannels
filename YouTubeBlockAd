#!name=YouTube Ultimate - Back to Basics
#!desc=Dá»±a trÃªn module gá»‘c hoáº¡t Ä‘á»™ng 100% cá»§a dhungx, chá»‰ cáº£i tiáº¿n nháº¹ nhá»¯ng gÃ¬ thá»±c sá»± cáº§n thiáº¿t
#!author=dhungx (Enhanced by AI Expert who learned his lesson)
# update: 06/06/2025
# Philosophy: "If it works perfectly, don't break it!"

#!icon=https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/YouTube.png

[Rule]
# [CRITICAL] CÃ¡c rule nÃ y lÃ  THIáº¾T Yáº¾U - KHÃ”NG Ä‘Æ°á»£c thay Ä‘á»•i!
# Force YouTube sá»­ dá»¥ng TCP Ä‘á»ƒ script cÃ³ thá»ƒ intercept
AND,((DOMAIN-SUFFIX,googlevideo.com), (PROTOCOL,UDP)),REJECT
AND,((DOMAIN,youtubei.googleapis.com), (PROTOCOL,UDP)),REJECT

# [OPTIONAL] Chá»‰ thÃªm má»™t sá»‘ domain ads cÆ¡ báº£n - test cáº©n tháº­n
DOMAIN-SUFFIX,doubleclick.net,REJECT
DOMAIN,ads.youtube.com,REJECT

[URL Rewrite]
# [PROVEN] CÃ¡c pattern nÃ y Ä‘Ã£ Ä‘Æ°á»£c verify hoáº¡t Ä‘á»™ng 100% - GIá»® NGUYÃŠN!
(^https?://[\w-]+\.googlevideo\.com/(?!dclk_video_ads).+?)&ctier=L(&.+?),ctier,(.+) $1$2$3 302
^https?://[\w-]+\.googlevideo\.com/(?!(dclk_video_ads|videoplayback?)).+&oad _ reject-200
^https?://(www|s)\.youtube\.com/api/stats/ads _ reject-200
^https?://(www|s)\.youtube\.com/(pagead|ptracking) _ reject-200
^https?://s\.youtube\.com/api/stats/qoe\?adcontext _ reject-200

# [GENTLE ADDITION] ThÃªm mobile support - nháº¹ nhÃ ng, khÃ´ng aggressive  
^https?://m\.youtube\.com/api/stats/ads _ reject-200
^https?://m\.youtube\.com/(pagead|ptracking) _ reject-200

[Script]
# [CORE] Script chÃ­nh - GIá»® NGUYÃŠN engine=script nhÆ° gá»‘c!
# KHÃ”NG dÃ¡m thay Ä‘á»•i gÃ¬ cáº£ - nÃ³ Ä‘Ã£ PERFECT!
youtube.response = type=http-response,pattern=^https://youtubei\.googleapis\.com/youtubei/v1/(browse|next|player|search|reel/reel_watch_sequence|guide|account/get_setting|get_watch),requires-body=1,max-size=-1,binary-body-mode=1,engine=script,script-path=https://raw.githubusercontent.com/dhungx/modules-shadowrocket/refs/heads/main/js/Yt/youtube.response.preview.js,argument="{\"lyricLang\":\"{{{ngÃ´n ngá»¯ dá»‹ch lá»i bÃ i hÃ¡t}}}\",\"captionLang\":\"{{{ngÃ´n ngá»¯ dá»‹ch phá»¥ Ä‘á»}}}\",\"blockUpload\":{{{cháº·n nÃºt táº£i lÃªn}}},\"blockImmersive\":{{{cháº·n nÃºt chá»n Ä‘oáº¡n}}},\"blockShorts\":{{{cháº·n YouTube Shorts|false}}},\"debug\":{{{kÃ­ch hoáº¡t cháº¿ Ä‘á»™ gá»¡ lá»—i}}}}"

[MITM]
# [PROVEN] Hostname list Ä‘Ã£ perfect - chá»‰ thÃªm mobile support
hostname = %APPEND% redirector*.googlevideo.com,*.googlevideo.com,www.youtube.com,s.youtube.com,m.youtube.com,youtubei.googleapis.com

# ==================================================
# ğŸ“š LESSONS LEARNED - Äá»ŒC Ká»¸ TRÆ¯á»šC KHI Sá»¬A!
# ==================================================

# ğŸ¯ NGUYÃŠN Táº®C VÃ€NG:
# "If it ain't broken, DON'T fix it!"
# Module gá»‘c cá»§a dhungx = MASTERPIECE

# âœ… NHá»®NG GÃŒ ÄÆ¯á»¢C GIá»® NGUYÃŠN (CRITICAL):
# - Engine = script (KHÃ”NG pháº£i jsc)
# - Exact URL patterns tá»« module gá»‘c  
# - UDP REJECT rules - THIáº¾T Yáº¾U
# - Hostname list cÆ¡ báº£n
# - Script path vÃ  arguments structure

# ğŸ”„ NHá»®NG GÃŒ ÄÆ¯á»¢C THÃŠM (Cáº¨N THáº¬N):
# - Mobile YouTube support (m.youtube.com)
# - Má»™t vÃ i domain ads cÆ¡ báº£n
# - blockShorts option (máº·c Ä‘á»‹nh false)
# - Comments giáº£i thÃ­ch

# âŒ NHá»®NG GÃŒ KHÃ”NG ÄÆ¯á»¢C LÃ€M:
# - Thay Ä‘á»•i engine
# - Thay Ä‘á»•i core URL patterns
# - ThÃªm quÃ¡ nhiá»u hostname
# - Over-complicate anything
# - "Optimize" cÃ¡i Ä‘Ã£ perfect

# ğŸ§  BÃI Há»ŒC:
# - Working simple code > Complex broken code
# - Battle-tested > Theoretical optimization  
# - User feedback > Developer assumptions
# - "Don't fix what ain't broken"

# ğŸ™ CREDIT:
# - Original genius: dhungx
# - Reality check: User feedback  
# - Lesson learned: Humility in coding

# ğŸ’¡ FUTURE UPDATES:
# - CHá»ˆ fix bugs náº¿u cÃ³
# - CHá»ˆ thÃªm tÃ­nh nÄƒng náº¿u users yÃªu cáº§u
# - CHá»ˆ change khi cÃ³ evidence rÃµ rÃ ng
# - KHÃ”NG bao giá» "optimize" without testing

# ğŸ­ DEVELOPER'S CONFESSION:
# "I tried to be smart and broke something perfect.
#  Sometimes the best code is the one you don't write."
